<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图书购物车</title>
    <script>
        // 假设用户ID存储在Cookies中
        function getCookie(name) {
            let cookieArray = document.cookie.split('; ');
            for(let cookie of cookieArray) {
                let [cookieName, cookieValue] = cookie.split('=');
                if(cookieName === name) {
                    return cookieValue;
                }
            }
            return null;
        }

        const userId = getCookie("userId"); // 从Cookie获取用户ID

        function addToCart(bookId, quantity) {
            fetch('/AddToCartServlet', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ userId: userId, bookId: bookId, quantityPurchased: quantity })
            })
                .then(response => response.json())
                .then(data => alert("添加到购物车: " + data.message))
                .catch(error => console.error('Error:', error));
        }

        function removeFromCart(bookId) {
            fetch('/RemoveFromCartServlet', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ userId: userId, bookId: bookId })
            })
                .then(response => response.json())
                .then(data => alert("从购物车中删除: " + data.message))
                .catch(error => console.error('Error:', error));
        }

        function placeOrder(bookId) {
            fetch('/PlaceOrderServlet', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ userId: userId, bookId: bookId })
            })
                .then(response => response.json())
                .then(data => alert("下单: " + data.message))
                .catch(error => console.error('Error:', error));
        }
    </script>
</head>
<body>
<h2>图书购物车</h2>

<!-- 示例用的输入 -->
书籍ID: <label for="bookId"></label><input type="text" id="bookId" /><br />
数量: <label for="quantity"></label><input type="number" id="quantity" /><br />
<button onclick="addToCart(document.getElementById('bookId').value, document.getElementById('quantity').value)">添加到购物车</button>
<button onclick="removeFromCart(document.getElementById('bookId').value)">从购物车中删除</button>
<button onclick="placeOrder(document.getElementById('bookId').value)">下单</button>
</body>
</html>
